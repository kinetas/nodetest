<!-- <!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>Chroma RAG í…ŒìŠ¤íŠ¸</title>
  <style>
    body { font-family: sans-serif; padding: 2rem; }
    pre { background: #f4f4f4; padding: 1rem; border-radius: 5px; }
    input, button { font-size: 1rem; margin: 0.5rem 0; padding: 0.5rem; }
  </style>
</head>
<body>
  <h1>ğŸ§  RAG ì¶”ì²œ ìš”ì²­</h1>
  <input type="text" id="category" placeholder="ì˜ˆ: ì—¬í–‰, ê³µë¶€, ìš´ë™" />
  <button onclick="getRecommendation()">ì¶”ì²œ ìš”ì²­</button>
  <p><strong>ì¶”ì²œ ê²°ê³¼:</strong></p>
  <pre id="result">ì•„ì§ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤.</pre>

  <hr />

  <h2>ğŸ“„ Chroma DB ë¬¸ì„œ ëª©ë¡</h2>
  <button onclick="loadDocuments()">ë¬¸ì„œ ë¶ˆëŸ¬ì˜¤ê¸°</button>
  <pre id="docList">ë¬¸ì„œ ëª©ë¡ì„ ë¶ˆëŸ¬ì˜¤ì„¸ìš”.</pre>

  <script>
    async function getRecommendation() {
      const category = document.getElementById('category').value;
      const res = await fetch('/recommend', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ category })
      });
      const data = await res.json();
      document.getElementById('result').textContent = data.message;
    }

    async function loadDocuments() {
      const res = await fetch('/documents');
      const data = await res.json();
      document.getElementById('docList').textContent = JSON.stringify(data, null, 2);
    }
  </script>
</body>
</html> -->

<!-- <!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>Chroma RAG í…ŒìŠ¤íŠ¸</title>
  <style>
    body { font-family: sans-serif; padding: 2rem; }
    pre { background: #f4f4f4; padding: 1rem; border-radius: 5px; }
    input, button { font-size: 1rem; margin: 0.5rem 0; padding: 0.5rem; }
  </style>
</head>
<body>
  <h1>ğŸ§  RAG ì¶”ì²œ ìš”ì²­</h1>
  <input type="text" id="category" placeholder="ì˜ˆ: ì—¬í–‰, ê³µë¶€, ìš´ë™" />
  <button onclick="getRecommendation()">ì¶”ì²œ ìš”ì²­</button>

  <p><strong>ì¶”ì²œ ê²°ê³¼:</strong></p>
  <pre id="result">ì•„ì§ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤.</pre>
  <p><strong>â±ï¸ ì‘ë‹µ ì‹œê°„:</strong> <span id="responseTime">-</span> ì´ˆ</p>

  <hr />

  <h2>ğŸ“„ Chroma DB ë¬¸ì„œ ëª©ë¡</h2>
  <button onclick="loadDocuments()">ë¬¸ì„œ ë¶ˆëŸ¬ì˜¤ê¸°</button>
  <pre id="docList">ë¬¸ì„œ ëª©ë¡ì„ ë¶ˆëŸ¬ì˜¤ì„¸ìš”.</pre>

  <script>
    async function getRecommendation() {
      const category = document.getElementById('category').value;
      const res = await fetch('/ai/recommend', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ category })
      });
      const data = await res.json();
      document.getElementById('result').textContent = data.message;
      document.getElementById('responseTime').textContent = data.response_time_sec + "ì´ˆ";

      console.log("ì „ì²´ JSON ì‘ë‹µ:", data);
      const fullJson = document.createElement('pre');
      fullJson.textContent = JSON.stringify(data, null, 2);

      const oldDebug = document.getElementById("jsonDebug");
      if (oldDebug) oldDebug.replaceWith(fullJson);
      fullJson.id = "jsonDebug";
      
      document.body.appendChild(fullJson);
    }

    async function loadDocuments() {
      const res = await fetch('/ai/documents');
      const data = await res.json();
      document.getElementById('docList').textContent = JSON.stringify(data, null, 2);
    }
  </script>
</body>
</html> -->

<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>Chroma RAG í…ŒìŠ¤íŠ¸</title>
  <style>
    body { font-family: sans-serif; padding: 2rem; }
    pre { background: #f4f4f4; padding: 1rem; border-radius: 5px; }
    input, button { font-size: 1rem; margin: 0.5rem 0; padding: 0.5rem; }
  </style>
</head>
<body>
  <h1>ğŸ§  RAG ì¶”ì²œ ìš”ì²­</h1>
  <input type="text" id="category" placeholder="ì˜ˆ: ì—¬í–‰, ê³µë¶€, ìš´ë™" />
  <button onclick="getRecommendation()">ì¶”ì²œ ìš”ì²­</button>

  <p><strong>ì¶”ì²œ ê²°ê³¼:</strong></p>
  <pre id="result">ì•„ì§ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤.</pre>
  <p><strong>â±ï¸ ì‘ë‹µ ì‹œê°„:</strong> <span id="responseTime">-</span> ì´ˆ</p>

  <hr />

  <h2>ğŸ“„ Chroma DB ë¬¸ì„œ ëª©ë¡</h2>
  <button onclick="loadDocuments()">ë¬¸ì„œ ë¶ˆëŸ¬ì˜¤ê¸°</button>
  <pre id="docList">ë¬¸ì„œ ëª©ë¡ì„ ë¶ˆëŸ¬ì˜¤ì„¸ìš”.</pre>

  <script>
    async function getRecommendation() {
      const category = document.getElementById('category').value;
      const jwtToken = localStorage.getItem('jwt_token');

      if (!jwtToken) {
        alert("âŒ JWT í† í°ì´ ì—†ìŠµë‹ˆë‹¤. ë¨¼ì € ë¡œê·¸ì¸ í•´ì£¼ì„¸ìš”.");
        return;
      }

      try {
        const res = await fetch('/ai/recommend', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
            'Authorization': `Bearer ${jwtToken}`
          },
          body: JSON.stringify({ category })
        });

        const data = await res.json();
        if (res.status !== 200) {
          throw new Error(data.detail || "ì˜¤ë¥˜ ë°œìƒ");
        }

        document.getElementById('result').textContent = data.message;
        document.getElementById('responseTime').textContent = data.response_time_sec + "ì´ˆ";

        console.log("ì „ì²´ JSON ì‘ë‹µ:", data);
        const fullJson = document.createElement('pre');
        fullJson.textContent = JSON.stringify(data, null, 2);

        const oldDebug = document.getElementById("jsonDebug");
        if (oldDebug) oldDebug.replaceWith(fullJson);
        fullJson.id = "jsonDebug";

        document.body.appendChild(fullJson);
      } catch (err) {
        console.error("âŒ ìš”ì²­ ì‹¤íŒ¨:", err);
        alert("ìš”ì²­ ì‹¤íŒ¨: " + err.message);
      }
    }

    async function loadDocuments() {
      const res = await fetch('/ai/documents');
      const data = await res.json();
      document.getElementById('docList').textContent = JSON.stringify(data, null, 2);
    }
  </script>
</body>
</html>
